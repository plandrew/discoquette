(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(6616)}])},7289:function(e,t,r){"use strict";r.r(t),r.d(t,{Playlist:function(){return l}});var a=r(5893),n=r(869),s=r.n(n),i=r(7294),o=r(2518);function l(e){let[t,r]=(0,i.useState)(""),{playlistTracks:n}=e,{createPlaylist:l}=e;return n?(0,a.jsxs)("div",{className:s().playlist,children:[(0,a.jsx)("h2",{children:"Playlist"}),(0,a.jsxs)("form",{children:[(0,a.jsx)("label",{htmlFor:"playlistName"}),(0,a.jsx)("input",{id:"playlistName",value:t,onChange:e=>r(e.target.value),placeholder:"PlayList Name"})]}),(0,a.jsx)("datalist",{className:s().tracks,children:n.map(t=>(0,a.jsx)(o.default,{track:t,addOrRemoveFromPlaylist:e.addOrRemoveFromPlaylist}))}),(0,a.jsx)("button",{onClick:e=>{e.preventDefault(),l(t)},children:"SAVE TO SPOTIFT"})]}):(0,a.jsx)("div",{children:"Loading..."})}t.default=l},8251:function(e,t,r){"use strict";r.r(t),r.d(t,{Searchbar:function(){return o}});var a=r(5893),n=r(7294),s=r(2763),i=r.n(s);function o(e){let[t,r]=(0,n.useState)(""),{getTracks:s}=e;return(0,a.jsxs)("form",{className:i().searchbar,children:[(0,a.jsx)("input",{type:"text",role:"searchbox",id:"artist",value:t,onChange:function(e){r(e.target.value)},placeholder:"Search by an artist",className:i().search}),(0,a.jsx)("button",{type:"submit",onClick:e=>{e.preventDefault(),void 0!==t&&s(t),r()},children:"Search"})]})}t.default=o},1172:function(e,t,r){"use strict";r.r(t),r.d(t,{Searchresults:function(){return o}});var a=r(5893),n=r(2518),s=r(2170),i=r.n(s);function o(e){let{tracks:t}=e,{addOrRemoveFromPlaylist:r}=e;return t?(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{children:"Results"}),(0,a.jsx)("datalist",{className:i().searchresults,"aria-role":"",children:t.map(e=>(0,a.jsx)(n.default,{track:e,addOrRemoveFromPlaylist:r}))})]}):(0,a.jsx)("div",{children:"Loading..."})}t.default=o},2518:function(e,t,r){"use strict";r.r(t);var a=r(5893),n=r(1953),s=r.n(n);t.default=function(e){let{addOrRemoveFromPlaylist:t}=e,{track:r}=e;return r?(0,a.jsxs)("li",{className:s().li,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:s().h4,"aria-label":"Track Name",children:r.name.split(" (")[0]}),(0,a.jsx)("p",{className:s().p,"aria-label":"Album Name",children:r.album.name.split(" (")[0]})]}),(0,a.jsx)("button",{onClick:()=>{t(r.id)},children:"+|-"})]}):(0,a.jsx)("div",{children:"Loading..."})}},6616:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var a=r(5893),n=r(7294),s=r(7289),i=r(8251),o=r(1172),l=r(9812),c=r.n(l);function d(){let[e,t]=(0,n.useState)(""),[r,l]=(0,n.useState)(""),[d,u]=(0,n.useState)([]),[h,f]=(0,n.useState)(""),[p,m]=(0,n.useState)([]),_="0a7f801c76fe4efdacea3c10662f2b9a",y="http://localhost:3000";function x(e){let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let a=0;a<e;a++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}async function j(e){let t=new TextEncoder,r=t.encode(e),a=await window.crypto.subtle.digest("SHA-256",r);return btoa(String.fromCharCode.apply(null,new Uint8Array(a))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}let k=x(128);async function b(t){let r=await fetch("https://api.spotify.com/v1/users/31mouwpyor2lmfifwz2jqnpdlaaq/playlists",{method:"POST",headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"},body:JSON.stringify({name:t,public:!1})});if(!r.ok){let e=await r.text();throw Error("Failed to create playlist: ".concat(e))}let a=await r.json(),n=Array.from(p,e=>"spotify:track:".concat(e.id));fetch("https://api.spotify.com/v1/playlists/".concat(a.id,"/tracks"),{method:"POST",headers:{Authorization:"Bearer "+e},body:JSON.stringify({uris:n})}).then(e=>{if(!e.ok)throw Error("HTTP error "+e.status);return e.json()}).catch(e=>{console.error("Error:",e)})}(0,n.useEffect)(()=>{let e=new URLSearchParams(window.location.search),r=e.get("code");if(null!==r){let e=localStorage.getItem("code_verifier"),a=new URLSearchParams({grant_type:"authorization_code",code:r,redirect_uri:y,client_id:_,code_verifier:e});fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a}).then(e=>{if(!e.ok)throw Error("HTTP status "+e.status);return e.json()}).then(e=>{t(e.access_token),l(e.refresh_token)}).catch(e=>{console.error("Error:",e)});let n=window.location.href.split("?")[0];history.replaceState(null,null,n)}},[]);let w=e=>{let t=d.find(t=>t.id===e),r=p.find(t=>t.id===e);if(t){m(e=>[t,...e]);let e=d.filter(e=>e!==t);u(e)}else{u(e=>[r,...e]);let e=p.filter(e=>e!==r);m(e)}};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("header",{children:[(0,a.jsx)("h1",{children:"Discoquette"}),(0,a.jsx)("button",{"aria-label":"Login",onClick:function(){j(k).then(e=>{let t=x(16);localStorage.setItem("code_verifier",k);let r=new URLSearchParams({response_type:"code",client_id:_,scope:"user-library-read user-library-modify user-top-read user-read-private user-read-email playlist-modify-public playlist-modify-private playlist-read-private playlist-read-collaborative",redirect_uri:y,state:t,code_challenge_method:"S256",code_challenge:e});window.location="https://accounts.spotify.com/authorize?"+r})},children:"Login"}),(0,a.jsx)("button",{"aria-label":"Refresh Token",onClick:function(){if(r){localStorage.getItem("code_verifier");let e=new URLSearchParams({grant_type:"refresh_token",refresh_token:r,client_id:_});fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}).then(e=>{if(!e.ok)throw Error("HTTP status "+e.status);return e.json()}).then(e=>{t(e.access_token)}).catch(e=>{console.error("Error:",e)})}},children:"Refresh Token"})]}),(0,a.jsxs)("main",{className:c().main,children:[(0,a.jsx)("section",{className:c().searchbar,children:(0,a.jsx)(i.default,{getTracks:function(t){if("string"==typeof t){let r=encodeURIComponent(t),a="https://api.spotify.com/v1/search?q=artist%3A".concat(r,"&type=track&market=pl&limit=10&offset=0");fetch(a,{headers:{Authorization:"Bearer "+e}}).then(e=>{if(!e.ok)throw Error("HTTP error "+e.status);return e.json()}).then(e=>{u(e.tracks.items)}).catch(e=>{console.error("Error:",e)})}}})}),(0,a.jsxs)("section",{className:c().content,children:[(0,a.jsx)(o.Searchresults,{addOrRemoveFromPlaylist:w,tracks:d}),(0,a.jsx)(s.default,{playlistTracks:p,addOrRemoveFromPlaylist:w,createPlaylist:b})]})]})]})}},9812:function(e){e.exports={searchbar:"Index_searchbar__cnjsC",content:"Index_content__8ktUb",main:"Index_main__UtI_f"}},869:function(e){e.exports={playlist:"Playlist_playlist__n_kh5",tracks:"Playlist_tracks__P_IyI"}},2763:function(e){e.exports={searchbar:"Searchbar_searchbar__nbjdF"}},2170:function(e){e.exports={searchresults:"Searchresults_searchresults__oknmJ"}},1953:function(e){e.exports={p:"Track_p__WC7zj",li:"Track_li__KGX7Q",h4:"Track_h4__eVzzh"}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);